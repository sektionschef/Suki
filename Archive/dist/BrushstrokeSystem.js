class BrushstrokeSystem{constructor(t){this.orientation=t.orientation,this.brushCount=t.brushCount,this.brushTemplateCount=t.brushTemplateCount,this.brushTemplateSize=t.brushTemplateSize,this.brushTemplateStrokeSize=t.brushTemplateStrokeSize,this.brushTemplateFillColor=t.brushTemplateFillColor,this.brushTemplateFillColorDistort=t.brushTemplateFillColorDistort,this.brushTemplateStrokeColor=t.brushTemplateStrokeColor,this.brushTemplateStrokeColorDistort=t.brushTemplateStrokeColorDistort,this.brushCurveSexyness=t.brushCurveSexyness,this.noiseIncrement=t.noiseIncrement,this.DEBUG=t.DEBUG,this.noiseColor=t.noiseColor,this.brushPixelDistort=t.brushPixelDistort,this.brushOpacityDistort=t.brushOpacityDistort,this.brushType=t.brushType,this.originA=t.originA,this.originB=t.originB,this.targetA=t.targetA,this.targetB=t.targetB,this.distanceAB=p5.Vector.dist(this.originA,this.originB),this.densityFactor=this.distanceAB/this.brushCount,this.loopGrow=p5.Vector.sub(this.originB,this.originA).normalize(),this.allFinished=!1,this.buffer=createGraphics(width,height,SVG),this.brushTemplates=[],this.brushstrokes=[],this.createBrushTemplates();let s=0;for(var e=0;e<this.brushCount;e++)t.origin=p5.Vector.add(this.originA,p5.Vector.mult(this.loopGrow,e*this.densityFactor)),t.target=p5.Vector.add(this.targetA,p5.Vector.mult(this.loopGrow,e*this.densityFactor)),t.sprite=getRandomFromList(this.brushTemplates),t.drawBuffer=this.buffer,s+=this.noiseIncrement,t.turningFactor=1*noise(s),t.brushIndex=e,this.brushstrokes.push(new Brushstroke(t));this.create()}createBrushTemplates(){for(var t=0;t<this.brushTemplateCount;t++){let t={size:this.brushTemplateSize,fillColor:this.brushTemplateFillColor,pixelDistort:this.brushPixelDistort};this.brushTemplates.push(new Brush(t).buffer)}}showBrushTemplates(){for(var t=0;t<this.brushTemplates.length;t++)image(this.brushTemplates[t],t*this.brushTemplates[t].width,0)}check_all_complete(){if(0==this.allFinished||this.brushstrokes.length>0){for(var t of(this.brushstrokes_alive=[],this.brushstrokes))this.brushstrokes_alive.push(t.finished);this.brushstrokes_alive.every((t=>!0===t))&&(this.allFinished=!0)}}create(){for(;0==this.allFinished;){for(var t=0;t<this.brushstrokes.length;t++){var s=this.brushstrokes[t];0==s.finished&&(s.updateBrushstroke(),s.showBrushstroke(),s.applyForce(s.seek(!0)))}this.check_all_complete()}}show(){this.allFinished&&(push(),image(this.buffer,0,0),pop()),this.DEBUG&&(push(),translate(this.originA.x,this.originA.y),fill(color("orange")),noStroke(),circle(0,0,50),pop(),push(),translate(this.targetA.x,this.targetA.y),fill(color("green")),noStroke(),circle(0,0,50),pop(),push(),translate(this.originB.x,this.originB.y),fill(color("orange")),noStroke(),circle(0,0,50),pop(),push(),translate(this.targetB.x,this.targetB.y),fill(color("green")),noStroke(),circle(0,0,50),pop())}}