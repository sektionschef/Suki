class Grid{constructor(t){if(this.stripeOrientation=t.stripeOrientation,this.thickness=t.thickness,this.spacing=t.spacing,this.countColumnOrRow=t.countColumnOrRow,this.bezierFactor=t.bezierFactor,this.backgroundNoise=t.backgroundNoise,"last"==t.whichLoopLevel?this.whichLoopLevel=1:"secondlast"==t.whichLoopLevel?this.whichLoopLevel=2:this.whichLoopLevel=3,this.DEBUG=!1,this.paperMargin=.05*SHORTSIDE,this.sizeStripeMin=15,this.paddingHeightCountMin=5,this.paddingHeightCountMax=5,this.paddingWidthCountMin=5,this.paddingWidthCountMax=5,this.shortBoxCount=80,this.boxSize=SHORTSIDE/this.shortBoxCount,this.longBoxCount=Math.floor(LONGSIDE/this.boxSize),this.bezierOffset=this.bezierFactor*SHORTSIDE,this.shortMargin=SHORTSIDE%this.boxSize,0!=this.shortMargin)throw new Error("wtf, there is a margin!");this.longMargin=LONGSIDE%this.boxSize/2,width<height?(this.widthBoxCount=this.shortBoxCount,this.heightBoxCount=this.longBoxCount,this.widthMargin=this.shortMargin,this.heightMargin=this.longMargin):(this.widthBoxCount=this.longBoxCount,this.heightBoxCount=this.shortBoxCount,this.widthMargin=this.longMargin,this.heightMargin=this.shortMargin),this.sizeStripe=Math.floor(getRandomFromInterval(this.sizeStripeMin,this.shortBoxCount/this.countColumnOrRow-this.sizeStripeMin)),this.columns=new Set,this.rows=new Set,this.boxes=[],this.stripes=[],this.stripeLines=[],this.sInc=.1,this.lInc=.03,this.zInc=.05,this.sInc2=.06,this.lInc2=.06,this.zInc2=.2,this.sInc3=.2,this.lInc3=.2,this.zInc3=.2,this.buffer=createGraphics(width,height,SVG),this.bufferNoise=createGraphics(width,height,SVG),this.totalA=createVector(this.buffer.width/2,this.buffer.height/2),this.totalC=createVector(this.buffer.width/2,this.buffer.height/2),this.createBoxes(),this.draw()}createBoxes(){var t=0;let i=0,s=0,e=0,h=0,o=0,n=0;for(var r=0;r<this.heightBoxCount;r++){let p=0,I=0,S=0;for(var a=0;a<this.widthBoxCount;a++){var g=createVector(this.widthMargin+a*this.boxSize+this.boxSize/2,this.heightMargin+r*this.boxSize+this.boxSize/2),x=createVector(this.widthMargin+a*this.boxSize,this.heightMargin+r*this.boxSize),b=p5.Vector.add(x,createVector(this.boxSize,0)),c=p5.Vector.add(x,createVector(this.boxSize,this.boxSize)),l=p5.Vector.add(x,createVector(0,this.boxSize)),u=noise(p,i,s),f=noise(I,e,h),d=noise(S,o,n),z=insidePolygon([x.x,x.y],polyPoints);this.boxes.push({center:g,A:x,B:b,C:c,D:l,long:r,short:a,index:t,mask:!1,noiseValue:u,noiseValue2:f,noiseValue3:d,polygonA:z}),t+=1,p+=this.sInc,I+=this.sInc2,S+=this.sInc3}i+=this.lInc,s+=this.zInc,e+=this.lInc2,h+=this.zInc2,o+=this.lInc3,n+=this.zInc3}}showDebug(){}draw(){let t=0,i=0,s=0,e=0,h=0,o=0,n=[],r=[],a=[],g=[];for(var x=0;x<this.boxes.length;x++)t=getRandomFromInterval(-10,10),i=20,s=20,e=3,h=0,o=2*PI,n=["#bec9cf","#a3b6c0","#9db5c2"],r=["#818a8f","#728088","#677a85"],this.boxes[x].noiseValue2>=.5&&fxrand()>.2?this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue2,i,s,e,h,o,r):this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue,i,s,e,h,o,n);for(x=0;x<this.boxes.length;x++)t=getRandomFromInterval(-5,5),i=10,s=10,e=2,h=0,o=PI,n=["#90a4af","#7e9099","#6c7b83"],r=["#6f7f88","#627179","#4d585e"],this.boxes[x].noiseValue2>=.5&&fxrand()>.3?this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue2,i,s,e,h,o,r):this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue,i,s,e,h,o,n);for(x=0;x<this.boxes.length;x++)t=getRandomFromInterval(-2,2),i=50,s=20,e=.2,h=0,o=PI,n=["#43525a","#4b5a61","#43555f"],r=["#2f393f","#323c41","#2d3a41"],this.boxes[x].noiseValue2>=.5&&fxrand()>.5?this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue2,i,s,e,h,o,r):this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue,i,s,e,h,o,n);for(x=0;x<this.boxes.length;x++)t=getRandomFromInterval(-2,2),i=10,s=20,e=.4,h=PI,o=2*PI,n=["#43525a","#4b5a61","#43555f"],r=["#2f393f","#323c41","#2d3a41"],a=["#d9e9f3","#c3dbe7","#c5e3f3"],this.boxes[x].noiseValue3<=.4&&fxrand()>.5&&this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue3,i,s,e,h,o,a),this.boxes[x].polygonA&&(t=getRandomFromInterval(-10,10),i=20,s=10,e=2,h=0,o=2*PI,g=["#496370","#608ba1","#6f8591"],fxrand()>.25&&this.zigzag(this.boxes[x].A.x+t,this.boxes[x].A.y+t,this.boxes[x].noiseValue3,i,s,e,h,o,g))}zigzag(t,i,s,e,h,o,n,r,a){let g=createVector(t,i);this.buffer.push(),this.buffer.noFill(),this.buffer.strokeWeight(o),this.buffer.beginShape();for(var x=0;x<s*e;x++){let t=Math.round(s*(a.length-1)),i=distortColorSuperNew(a[t],10);this.buffer.stroke(i);let e=getRandomFromInterval(n,r),o=p5.Vector.fromAngle(e);o.setMag(s*h);let x=p5.Vector.add(g,o);this.buffer.vertex(x.x,x.y)}this.buffer.endShape(),this.buffer.pop()}show(){push(),image(this.buffer,0,0),pop()}}