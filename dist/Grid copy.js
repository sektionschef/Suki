class Grid{constructor(t){if(this.stripeOrientation=t.stripeOrientation,this.thickness=t.thickness,this.spacing=t.spacing,this.countColumnOrRow=t.countColumnOrRow,this.bezierFactor=t.bezierFactor,this.backgroundNoise=t.backgroundNoise,"last"==t.whichLoopLevel?this.whichLoopLevel=1:"secondlast"==t.whichLoopLevel?this.whichLoopLevel=2:this.whichLoopLevel=3,this.DEBUG=!1,this.paperMargin=.05*SHORTSIDE,this.sizeStripeMin=15,this.paddingHeightCountMin=5,this.paddingHeightCountMax=5,this.paddingWidthCountMin=5,this.paddingWidthCountMax=5,this.shortBoxCount=80,this.boxSize=SHORTSIDE/this.shortBoxCount,this.longBoxCount=Math.floor(LONGSIDE/this.boxSize),this.bezierOffset=this.bezierFactor*SHORTSIDE,this.shortMargin=SHORTSIDE%this.boxSize,0!=this.shortMargin)throw new Error("wtf, there is a margin!");this.longMargin=LONGSIDE%this.boxSize/2,width<height?(this.widthBoxCount=this.shortBoxCount,this.heightBoxCount=this.longBoxCount,this.widthMargin=this.shortMargin,this.heightMargin=this.longMargin):(this.widthBoxCount=this.longBoxCount,this.heightBoxCount=this.shortBoxCount,this.widthMargin=this.longMargin,this.heightMargin=this.shortMargin),this.sizeStripe=Math.floor(getRandomFromInterval(this.sizeStripeMin,this.shortBoxCount/this.countColumnOrRow-this.sizeStripeMin)),this.columns=new Set,this.rows=new Set,this.boxes=[],this.stripes=[],this.stripeLines=[],this.sInc=.1,this.lInc=.03,this.zInc=.05,this.sInc2=.06,this.lInc2=.06,this.zInc2=.2,this.buffer=createGraphics(width,height,SVG),this.bufferNoise=createGraphics(width,height,SVG),this.totalA=createVector(this.buffer.width/2,this.buffer.height/2),this.totalC=createVector(this.buffer.width/2,this.buffer.height/2),this.createBoxes(),this.draw()}createBoxes(){var t=0;let i=0,s=0,e=0,h=0;for(var o=0;o<this.heightBoxCount;o++){let f=0,l=0;for(var r=0;r<this.widthBoxCount;r++){var n=createVector(this.widthMargin+r*this.boxSize+this.boxSize/2,this.heightMargin+o*this.boxSize+this.boxSize/2),a=createVector(this.widthMargin+r*this.boxSize,this.heightMargin+o*this.boxSize),g=p5.Vector.add(a,createVector(this.boxSize,0)),b=p5.Vector.add(a,createVector(this.boxSize,this.boxSize)),c=p5.Vector.add(a,createVector(0,this.boxSize)),x=noise(f,i,s),u=noise(l,e,h);this.boxes.push({center:n,A:a,B:g,C:b,D:c,long:o,short:r,index:t,mask:!1,noiseValue:x,noiseValue2:u}),t+=1,f+=this.sInc,l+=this.sInc2}i+=this.lInc,s+=this.zInc,e+=this.lInc2,h+=this.zInc2}}showDebug(){}draw(){let t=0,i=0,s=0,e=0,h=0,o=0,r=[],n=[];for(var a=0;a<this.boxes.length;a++)this.buffer.push(),t=getRandomFromInterval(-10,10),i=20,s=20,e=3,h=0,o=2*PI,r=["#bec9cf","#a3b6c0","#9db5c2"],n=["#818a8f","#728088","#677a85"],this.boxes[a].noiseValue2>=.5?this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue2,i,s,e,h,o,n):this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue,i,s,e,h,o,r),this.buffer.pop();for(a=0;a<this.boxes.length;a++)this.buffer.push(),t=getRandomFromInterval(-5,5),i=10,s=10,e=2,h=0,o=PI,r=["#90a4af","#7e9099","#6c7b83"],n=["#6f7f88","#627179","#4d585e"],this.boxes[a].noiseValue2>=.5?this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue2,i,s,e,h,o,n):this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue,i,s,e,h,o,r),this.buffer.pop();for(a=0;a<this.boxes.length;a++)this.buffer.push(),t=getRandomFromInterval(-2,2),i=50,s=20,e=.2,h=0,o=PI,r=["#43525a","#4b5a61","#43555f"],n=["#2f393f","#323c41","#2d3a41"],this.boxes[a].noiseValue2>=.5?this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue2,i,s,e,h,o,n):this.zigzag(this.boxes[a].A.x+t,this.boxes[a].A.y+t,this.boxes[a].noiseValue,i,s,e,h,o,r),this.buffer.pop()}zigzag(t,i,s,e,h,o,r,n,a){let g=createVector(t,i);this.buffer.noFill(),this.buffer.strokeWeight(o),this.buffer.beginShape();for(var b=0;b<s*e;b++){let t=Math.round(s*(a.length-1)),i=distortColorSuperNew(a[t],10);this.buffer.stroke(i);let e=getRandomFromInterval(r,n),o=p5.Vector.fromAngle(e);o.setMag(s*h);let b=p5.Vector.add(g,o);this.buffer.vertex(b.x,b.y)}this.buffer.endShape()}show(){push(),image(this.buffer,0,0),pop()}}