let PalettiA=["#193352","#4a7592","#97b2c9"],PalettiB=["#203f63","#3c5c72","#7e9eb9"];class Grid{constructor(t){if(this.DEBUG=!1,this.paperMargin=.05*SHORTSIDE,this.shortBoxCount=80,this.boxSize=SHORTSIDE/this.shortBoxCount,this.longBoxCount=Math.floor(LONGSIDE/this.boxSize),this.shortMargin=SHORTSIDE%this.boxSize,0!=this.shortMargin)throw new Error("wtf, there is a margin!");this.longMargin=LONGSIDE%this.boxSize/2,width<height?(this.widthBoxCount=this.shortBoxCount,this.heightBoxCount=this.longBoxCount,this.widthMargin=this.shortMargin,this.heightMargin=this.longMargin):(this.widthBoxCount=this.longBoxCount,this.heightBoxCount=this.shortBoxCount,this.widthMargin=this.longMargin,this.heightMargin=this.shortMargin),this.columns=new Set,this.rows=new Set,this.boxes=[],this.stripes=[],this.stripeLines=[],this.sInc1=.03,this.lInc1=.03,this.zInc1=.03,this.sInc2=.06,this.lInc2=.04,this.zInc2=.06,this.sInc3=.08,this.lInc3=.07,this.zInc3=.08,this.sInc4=.08,this.lInc4=.08,this.zInc4=.07,this.sInc5=.1,this.lInc5=.1,this.zInc5=.1,this.sInc6=.2,this.lInc6=.2,this.zInc6=.2,this.sInc7=.02,this.lInc7=.02,this.zInc7=.02,this.sInc8=.02,this.lInc8=.02,this.zInc8=.02,this.buffer=createGraphics(width,height,SVG),this.bufferNoise=createGraphics(width,height,SVG),this.createBoxes(),this.DEBUG&&this.showDebug(),this.drawFourthLoop(),this.drawFirstLoop(),this.drawSecondLoop(),this.drawThirdLoop()}createBoxes(){var t=0;let s=0,i=0,e=0,h=0,o=0,n=0,r=0,a=0,l=0,x=0,f=0,g=0,u=0,b=0,c=0,d=0;for(var I=0;I<this.heightBoxCount;I++){let F=0,E=0,D=0,G=0,O=0,N=0,T=0,H=0;for(var p=0;p<this.widthBoxCount;p++){var S=createVector(this.widthMargin+p*this.boxSize+this.boxSize/2,this.heightMargin+I*this.boxSize+this.boxSize/2),V=createVector(this.widthMargin+p*this.boxSize,this.heightMargin+I*this.boxSize),z=p5.Vector.add(V,createVector(this.boxSize,0)),m=p5.Vector.add(V,createVector(this.boxSize,this.boxSize)),M=p5.Vector.add(V,createVector(0,this.boxSize)),v=noise(F,s,i),A=noise(E,e,h),B=noise(D,o,n),w=noise(G,r,a),L=noise(O,l,x),C=noise(N,f,g),P=noise(T,u,b),R=noise(H,c,d),y=insidePolygon([S.x,S.y],polyPoints),k=insidePolygon([S.x,S.y],polyPointsLeft);this.boxes.push({center:S,offset:createVector(getRandomFromInterval(-10,10),getRandomFromInterval(-10,10)),A:V,B:z,C:m,D:M,long:I,short:p,index:t,mask:!1,noiseValue1:v,noiseValue2:A,noiseValue3:B,noiseValue4:w,noiseValue5:L,noiseValue6:C,noiseValue7:P,noiseValue8:R,polygonA:y,polygonLeft:k}),t+=1,F+=this.sInc1,E+=this.sInc2,D+=this.sInc3,G+=this.sInc4,O+=this.sInc5,N+=this.sInc6,T+=this.sInc7,H+=this.sInc8}s+=this.lInc1,i+=this.zInc1,e+=this.lInc2,h+=this.zInc2,o+=this.lInc3,n+=this.zInc3,r+=this.lInc4,a+=this.zInc4,l+=this.lInc5,x+=this.zInc5,f+=this.lInc6,g+=this.zInc6,u+=this.lInc7,b+=this.zInc7,c+=this.lInc8,d+=this.zInc8}}showDebug(){this.buffer.push(),this.buffer.noFill(),this.buffer.strokeWeight(.1),this.buffer.stroke("black"),this.buffer.rectMode(CORNERS);for(var t=0;t<this.boxes.length;t++)this.buffer.rect(this.boxes[t].A.x,this.boxes[t].A.y,this.boxes[t].C.x,this.boxes[t].C.y);this.buffer.pop()}drawSkipMargin(t){return t.long<5||t.short<5||t.short>=this.shortBoxCount-4||t.long>=this.longBoxCount-4}drawNoise(t){let s="";s=1==t?"noiseValue1":2==t?"noiseValue2":3==t?"noiseValue3":4==t?"noiseValue4":5==t?"noiseValue5":"noiseValue6",this.buffer.push(),this.buffer.noStroke(),this.buffer.rectMode(CORNERS);for(var i=0;i<this.boxes.length;i++)this.drawSkipMargin(this.boxes[i])||(this.buffer.fill(255*this.boxes[i][s]),this.buffer.rect(this.boxes[i].A.x,this.boxes[i].A.y,this.boxes[i].C.x,this.boxes[i].C.y));this.buffer.pop()}drawBase(){this.buffer.push(),this.buffer.noStroke(),this.buffer.rectMode(CORNERS);let t=Math.round(getRandomFromInterval(0,PalettiA.length-1));this.buffer.fill(PalettiA[t]);for(var s=0;s<this.boxes.length;s++)this.drawSkipMargin(this.boxes[s])||this.buffer.rect(this.boxes[s].A.x,this.boxes[s].A.y,this.boxes[s].C.x,this.boxes[s].C.y);this.buffer.pop()}drawFirstLoop(){let t=getRandomIndex(this.boxes.length);t.length;for(var s=0;s<t.length;s++)this.drawSkipMargin(this.boxes[s])||(this.loopCountParam=30,this.vertexLength=20,this.strokeSize=3,this.angleMin=0,this.angleMax=2*PI,this.colorListA=PalettiA,this.colorListB=PalettiB,this.noiseValueA=this.boxes[s].noiseValue1,this.noiseValueB=this.boxes[s].noiseValue2,fxrand()>.05&&this.zigzag(this.boxes[s].A.x+this.boxes[s].offset.x,this.boxes[s].A.y+this.boxes[s].offset.y,this.noiseValueA,this.noiseValueB,this.loopCountParam,this.vertexLength,this.strokeSize,this.angleMin,this.angleMax,this.colorListA,this.colorListB))}drawSecondLoop(){let t=getRandomIndex(this.boxes.length);for(var s=0;s<t.length;s++)this.drawSkipMargin(this.boxes[s])||(this.loopCountParam=10,this.vertexLength=10,this.strokeSize=1,this.angleMin=0,this.angleMax=PI,this.colorListA=PalettiA,this.colorListB=PalettiB,this.noiseValueA=this.boxes[s].noiseValue3,this.noiseValueB=this.boxes[s].noiseValue4,fxrand()>.05&&this.zigzag(this.boxes[s].A.x+this.boxes[s].offset.x,this.boxes[s].A.y+this.boxes[s].offset.y,this.noiseValueA,this.noiseValueB,this.loopCountParam,this.vertexLength,this.strokeSize,this.angleMin,this.angleMax,this.colorListA,this.colorListB))}drawThirdLoop(){let t=getRandomIndex(this.boxes.length);for(var s=0;s<t.length;s++)this.drawSkipMargin(this.boxes[s])||(this.loopCountParam=30,this.vertexLength=25,this.strokeSize=.2,this.angleMin=0,this.angleMax=PI,this.colorListA=["#293236","#283033","#29353b"],this.colorListB=["#191e22","#191f22","#192125"],this.noiseValueA=this.boxes[s].noiseValue5,this.noiseValueB=this.boxes[s].noiseValue6,fxrand()>.05&&this.zigzag(this.boxes[s].A.x+this.boxes[s].offset.x,this.boxes[s].A.y+this.boxes[s].offset.y,this.noiseValueA,this.noiseValueB,this.loopCountParam,this.vertexLength,this.strokeSize,this.angleMin,this.angleMax,this.colorListA,this.colorListB))}drawFourthLoop(){let t=getRandomIndex(this.boxes.length);for(var s=0;s<t.length;s++)this.drawSkipMargin(this.boxes[s])||(this.loopCountParam=30,this.vertexLength=20,this.strokeSize=5,this.angleMin=0,this.angleMax=2*PI,this.colorListA=PalettiA,this.colorListB=PalettiB,this.noiseValueA=this.boxes[s].noiseValue7,this.noiseValueB=this.boxes[s].noiseValue8,fxrand()>.05&&this.zigzag(this.boxes[s].A.x+this.boxes[s].offset.x,this.boxes[s].A.y+this.boxes[s].offset.y,this.noiseValueA,this.noiseValueB,this.loopCountParam,this.vertexLength,this.strokeSize,this.angleMin,this.angleMax,this.colorListA,this.colorListB))}zigzag(t,s,i,e,h,o,n,r,a,l,x){let f=0,g=[];i>=.5&&fxrand()>.2?(f=i,g=l):(f=e,g=x);let u=createVector(t,s);this.buffer.push(),this.buffer.noFill(),this.buffer.strokeWeight(n);let b=Math.floor(f*g.length);this.buffer.beginShape();for(var c=0;c<f*h;c++){let t=distortColorSuperNew(g[b],10);this.buffer.stroke(t);let s=getRandomFromInterval(r,a),i=p5.Vector.fromAngle(s);i.setMag(f*o);let e=p5.Vector.add(u,i);this.buffer.vertex(e.x,e.y)}this.buffer.endShape(),this.buffer.pop()}drawShape(){let t=10,s=20;for(var i=0;i<800;i++){let i=createVector(getRandomFromInterval(100,width-100),getRandomFromInterval(100,height-100)),e=PalettiA[Math.round(getRandomFromInterval(0,PalettiA.length-1))];this.buffer.push(),this.buffer.noFill(),this.buffer.stroke(e),this.buffer.strokeWeight(1),this.buffer.beginShape(),this.buffer.vertex(i.x-getRandomFromInterval(t,s),i.y-getRandomFromInterval(t,s)),this.buffer.vertex(i.x+getRandomFromInterval(t,s),i.y-getRandomFromInterval(t,s)),this.buffer.vertex(i.x+getRandomFromInterval(t,s),i.y+getRandomFromInterval(t,s)),this.buffer.vertex(i.x-getRandomFromInterval(t,s),i.y+getRandomFromInterval(t,s)),this.buffer.endShape(CLOSE),this.buffer.pop()}}show(){push(),image(this.buffer,0,0),pop()}}